"use strict";(self.webpackChunksyncro_pi=self.webpackChunksyncro_pi||[]).push([[656],{534:(e,t,o)=>{o.d(t,{Z:()=>s});o(2791);var n=o(3329);const i=e=>{let{children:t,onConfirm:o,onCancel:i,...s}=e;return(0,n.jsx)("div",{id:"confirm",children:(0,n.jsxs)("div",{id:"confirm-modal",children:[t,(0,n.jsx)("div",{id:"confirm-buttons",children:(0,n.jsxs)("div",{id:"performance-buttons",children:[(0,n.jsx)("button",{type:"button",onClick:o,children:"Confirm"}),(0,n.jsx)("button",{type:"button",onClick:i,children:"Cancel"})]})})]})})};i.defaultProps={children:null};const s=i},5199:(e,t,o)=>{o.d(t,{Z:()=>u});var n=o(2791),i=o(4420),s=o(534),a=o(8978),c=o(3721),l=o(3329);const r=["geolocation"],d=e=>{let{interval:t=1e3,...o}=e;const d=(0,i.I0)(),[u,h]=(0,n.useState)(r[0]),[p,g]=(0,n.useState)([]),[m,v]=(0,n.useState)(!1),[f,y]=(0,n.useState)(!0),[b,S]=(0,n.useState)(0),P=(e,t)=>{console.log("Failure",u,b,3,t,(new Date).toLocaleTimeString()),S((o=>o>=2||t?(h((e=>{const t=r.find((t=>!p.includes(t)&&t!==e));return t?(console.log("Changing location method to ".concat(t)),g((t=>[...t,e])),t):e})),o):(console.log("Failed to get location via ".concat(u)),console.error(e),o+1)))},j=e=>({latitude:e.lat,longitude:e.lon,altitude:a.AD(e.alt),heading:e.track,climb:e.climb,tilt:0,speed:a.Li(e.speed),accuracy:a.AD(Math.max(e.epx,e.epy)),altitudeAccuracy:a.AD(e.epv),method:u}),x=e=>({latitude:e.coords.latitude,longitude:e.coords.longitude,altitude:a.AD(e.coords.altitude),heading:e.coords.heading,climb:0,tilt:0,speed:a.Li(e.coords.speed),accuracy:a.AD(e.coords.accuracy),altitudeAccuracy:a.AD(e.coords.altitudeAccuracy),method:u}),A=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;"gpsd"===e&&fetch("".concat("https://localhost:8443","/gps")).then((e=>e.json())).then(j).then((e=>d(c.ZP.setGPS(e)))).then((()=>setTimeout(A,t,u))).catch(P),"geolocation"===e&&(()=>{var e,o;null!==(e=navigator)&&void 0!==e&&null!==(o=e.permissions)&&void 0!==o&&o.query?navigator.permissions.query({name:"geolocation"}).then((e=>{"granted"===e.state||"prompt"===e.state?(v(!0),navigator.geolocation.getCurrentPosition((e=>{d(c.ZP.setGPS(x(e))),setTimeout(A,t)}),P,{enableHighAccuracy:!0})):(y(!1),P("Geolocation API permission denied by system"))})).catch((e=>{m?P(e):y(!1)})):navigator.geolocation&&navigator.geolocation.getCurrentPosition((e=>{d(c.ZP.setGPS(x(e))),setTimeout(A,t)}),P,{enableHighAccuracy:!0})})()};return(0,n.useEffect)((()=>S(0)),[u]),(0,n.useEffect)((()=>A(u)),[]),"geolocation"!==u||m||f?null:(0,l.jsx)(s.Z,{onConfirm:()=>{y(!0),A()},onCancel:()=>{y(!0),P("Geolocation API permission denied by user",!0)},children:(0,l.jsx)("span",{className:"show-unlit","data-unlit":a.jB(3,20),children:"You must grant permission to access GPS."})})};d.defaultProps={interval:1e3};const u=d},1656:(e,t,o)=>{o.r(t),o.d(t,{default:()=>l});var n=o(2791),i=o(4420),s=(o(5199),o(8978)),a=o(1930),c=o(3329);const l=e=>{const t=(0,i.v9)(a.$2),o=(0,i.v9)(a.RJ),[l,r]=(0,n.useState)(new Date),[d,u]=(0,n.useState)({start:null,end:null,topSpeed:null,to60:null,times:[],speeds:[]}),h=()=>String(Math.floor((null===o||void 0===o?void 0:o.speed)||0)).padStart(3,"0");return(0,c.jsx)("div",{id:"speed",children:(0,c.jsxs)("div",{id:"speed-speed",className:"show-unlit","data-unlit":s.ro(h()),children:[h(),(0,c.jsx)("span",{id:"speed-units",className:"original-font",children:"imperial"===t.units?"MPH":"Km/H"})]})})}}}]);
//# sourceMappingURL=656.d1afb762.chunk.js.map