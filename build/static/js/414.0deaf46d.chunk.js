"use strict";(self.webpackChunksyncro_pi=self.webpackChunksyncro_pi||[]).push([[414],{534:(t,e,n)=>{n.d(e,{Z:()=>a});n(2791);var o=n(3329);const r=t=>{let{children:e,onConfirm:n,onCancel:r,...a}=t;return(0,o.jsx)("div",{id:"confirm",children:(0,o.jsxs)("div",{id:"confirm-modal",children:[e,(0,o.jsx)("div",{id:"confirm-buttons",children:(0,o.jsxs)("div",{id:"performance-buttons",children:[(0,o.jsx)("button",{type:"button",onClick:n,children:"Confirm"}),(0,o.jsx)("button",{type:"button",onClick:r,children:"Cancel"})]})})]})})};r.defaultProps={children:null};const a=r},5199:(t,e,n)=>{n.d(e,{Z:()=>u});var o=n(2791),r=n(4420),a=n(534),i=n(8978),l=n(3721),s=n(3329);const c=["geolocation"],d=t=>{let{interval:e=1e3,...n}=t;const d=(0,r.I0)(),[u,p]=(0,o.useState)(c[0]),[h,m]=(0,o.useState)([]),[g,f]=(0,o.useState)(!1),[v,j]=(0,o.useState)(!0),[x,S]=(0,o.useState)(0),b=(t,e)=>{console.log("Failure",u,x,3,e,(new Date).toLocaleTimeString()),S((n=>n>=2||e?(p((t=>{const e=c.find((e=>!h.includes(e)&&e!==t));return e?(console.log("Changing location method to ".concat(e)),m((e=>[...e,t])),e):t})),n):(console.log("Failed to get location via ".concat(u)),console.error(t),n+1)))},y=t=>({latitude:t.lat,longitude:t.lon,altitude:i.AD(t.alt),heading:t.track,climb:t.climb,tilt:0,speed:i.Li(t.speed),accuracy:i.AD(Math.max(t.epx,t.epy)),altitudeAccuracy:i.AD(t.epv),method:u}),w=t=>({latitude:t.coords.latitude,longitude:t.coords.longitude,altitude:i.AD(t.coords.altitude),heading:t.coords.heading,climb:0,tilt:0,speed:i.Li(t.coords.speed),accuracy:i.AD(t.coords.accuracy),altitudeAccuracy:i.AD(t.coords.altitudeAccuracy),method:u}),C=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;"gpsd"===t&&fetch("".concat("https://192.168.50.22:3443","/gps")).then((t=>t.json())).then(y).then((t=>d(l.ZP.setGPS(t)))).then((()=>setTimeout(C,e,u))).catch(b),"geolocation"===t&&(()=>{var t,n;null!==(t=navigator)&&void 0!==t&&null!==(n=t.permissions)&&void 0!==n&&n.query?navigator.permissions.query({name:"geolocation"}).then((t=>{"granted"===t.state||"prompt"===t.state?(f(!0),navigator.geolocation.getCurrentPosition((t=>{d(l.ZP.setGPS(w(t))),setTimeout(C,e)}),b,{enableHighAccuracy:!0})):(j(!1),b("Geolocation API permission denied by system"))})).catch((t=>{g?b(t):j(!1)})):navigator.geolocation&&navigator.geolocation.getCurrentPosition((t=>{d(l.ZP.setGPS(w(t))),setTimeout(C,e)}),b,{enableHighAccuracy:!0})})()};return(0,o.useEffect)((()=>S(0)),[u]),(0,o.useEffect)((()=>C(u)),[]),"geolocation"!==u||g||v?null:(0,s.jsx)(a.Z,{onConfirm:()=>{j(!0),C()},onCancel:()=>{j(!0),b("Geolocation API permission denied by user",!0)},children:(0,s.jsx)("span",{className:"show-unlit","data-unlit":i.jB(3,20),children:"You must grant permission to access GPS."})})};d.defaultProps={interval:1e3};const u=d},8414:(t,e,n)=>{n.r(e),n.d(e,{default:()=>s});var o=n(2791),r=n(7830),a=n(5199),i=n(8978),l=n(3329);const s=t=>{const[e,n]=(0,o.useState)(new Date),[s,c]=(0,o.useState)(0),[d,u]=(0,o.useState)({start:null,end:null,topSpeed:null,to60:null,times:[],speeds:[]}),p=()=>n(new Date),h=()=>{u((t=>{if(t.end)return{...t};const e=Date.now();return setTimeout(h,100),{...t,start:t.start||e,topSpeed:Math.max(s,t.topSpeed),to60:s>=60&&!t.to60?s:t.to60}}))},m=()=>String(Math.floor(s||0)).padStart(3,"0"),g=()=>String(Math.floor(d.topSpeed||0)).padStart(3,"0"),f=()=>d.to60?"".concat(d.to60.toFixed(2)," s"):"N/A",v=()=>{const t=Date.now(),e=(d.end||t)-(d.start||t),n=String(Math.floor(e/1e3/60)||0).padStart(2,"0"),o=String(Math.floor(e/1e3%60)||0).padStart(2,"0"),r=String(e%1e3||0).padStart(3,"0");return"".concat(n,":").concat(o,".").concat(r)};return(0,o.useEffect)((()=>{const t=setInterval(p,1e3);return()=>clearInterval(t)}),[]),s||0===s?(0,l.jsxs)("div",{id:"performance",children:[(0,l.jsx)(a.Z,{onUpdate:t=>c(null===t||void 0===t?void 0:t.speed)}),(0,l.jsx)("div",{id:"performance-speed",className:"show-unlit","data-unlit":i.ro(m()),children:m()}),(0,l.jsx)("hr",{}),(0,l.jsxs)("div",{id:"performance-stats",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("span",{className:"show-unlit","data-unlit":i.ro("".concat(g()," mph")),children:[g()," mph"]}),(0,l.jsx)("span",{className:"show-unlit","data-unlit":i.ro("Top Spd"),children:"Top Spd"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"show-unlit","data-unlit":i.ro(f()),children:f()}),(0,l.jsx)("span",{className:"show-unlit","data-unlit":i.ro("00 - 60"),children:"00 - 60"})]})]}),(0,l.jsx)("hr",{}),(0,l.jsx)("div",{id:"performance-timer",className:"show-unlit","data-unlit":i.ro(v(),[":"]),children:v()}),(0,l.jsxs)("div",{id:"performance-buttons",children:[d.start&&!d.end?(0,l.jsx)("button",{type:"button",onClick:()=>u((t=>({...t,end:Date.now()}))),children:"Stop"}):(0,l.jsx)("button",{type:"button",onClick:d.end?()=>{u((t=>({...t,end:null}))),h()}:h,children:"Start"}),(0,l.jsx)("button",{type:"button",onClick:()=>u({start:null,end:null,topSpeed:null,to60:null,times:[],speeds:[]}),children:"Reset"})]})]}):(0,l.jsxs)("div",{id:"weather",children:[(0,l.jsx)(a.Z,{onUpdate:t=>c(null===t||void 0===t?void 0:t.speed)}),(0,l.jsx)(r.Z,{className:"big-icon"}),(0,l.jsx)("div",{id:"weather-description",children:"Error getting location"})]})}},7830:(t,e,n)=>{n.d(e,{Z:()=>d});var o=n(2791),r=n(2007),a=n.n(r),i=["color","size","title"];function l(){return l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},l.apply(this,arguments)}function s(t,e){if(null==t)return{};var n,o,r=function(t,e){if(null==t)return{};var n,o,r={},a=Object.keys(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var c=(0,o.forwardRef)((function(t,e){var n=t.color,r=t.size,a=t.title,c=s(t,i);return o.createElement("svg",l({ref:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:r,height:r,fill:n},c),a?o.createElement("title",null,a):null,o.createElement("path",{fillRule:"evenodd",d:"M3.1 11.2a.5.5 0 0 1 .4-.2H6a.5.5 0 0 1 0 1H3.75L1.5 15h13l-2.25-3H10a.5.5 0 0 1 0-1h2.5a.5.5 0 0 1 .4.2l3 4a.5.5 0 0 1-.4.8H.5a.5.5 0 0 1-.4-.8l3-4z"}),o.createElement("path",{fillRule:"evenodd",d:"M8 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6zM4 4a4 4 0 1 1 4.5 3.969V13.5a.5.5 0 0 1-1 0V7.97A4 4 0 0 1 4 3.999z"}))}));c.propTypes={color:a().string,size:a().oneOfType([a().string,a().number]),title:a().string},c.defaultProps={color:"currentColor",size:"1em",title:null};const d=c}}]);
//# sourceMappingURL=414.0deaf46d.chunk.js.map