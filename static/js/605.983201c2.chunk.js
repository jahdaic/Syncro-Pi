"use strict";(self.webpackChunksyncro_pi=self.webpackChunksyncro_pi||[]).push([[605],{534:(e,t,n)=>{n.d(t,{Z:()=>l});n(2791);var o=n(3329);const i=e=>{let{children:t,onConfirm:n,onCancel:i,...l}=e;return(0,o.jsx)("div",{id:"confirm",children:(0,o.jsxs)("div",{id:"confirm-modal",children:[t,(0,o.jsx)("div",{id:"confirm-buttons",children:(0,o.jsxs)("div",{id:"performance-buttons",children:[(0,o.jsx)("button",{type:"button",onClick:n,children:"Confirm"}),(0,o.jsx)("button",{type:"button",onClick:i,children:"Cancel"})]})})]})})};i.defaultProps={children:null};const l=i},5199:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(2791),i=n(4420),l=n(534),s=n(8978),a=n(3721),r=n(3329);const c=["geolocation"],d=e=>{let{interval:t=1e3,...n}=e;const d=(0,i.I0)(),[u,g]=(0,o.useState)(c[0]),[m,h]=(0,o.useState)([]),[v,p]=(0,o.useState)(!1),[f,y]=(0,o.useState)(!0),[x,j]=(0,o.useState)(0),b=(e,t)=>{console.log("Failure",u,x,3,t,(new Date).toLocaleTimeString()),j((n=>n>=2||t?(g((e=>{const t=c.find((t=>!m.includes(t)&&t!==e));return t?(console.log("Changing location method to ".concat(t)),h((t=>[...t,e])),t):e})),n):(console.log("Failed to get location via ".concat(u)),console.error(e),n+1)))},w=e=>({latitude:e.lat,longitude:e.lon,altitude:s.AD(e.alt),heading:e.track,climb:e.climb,tilt:0,speed:s.Li(e.speed),accuracy:s.AD(Math.max(e.epx,e.epy)),altitudeAccuracy:s.AD(e.epv),method:u}),P=e=>({latitude:e.coords.latitude,longitude:e.coords.longitude,altitude:s.AD(e.coords.altitude),heading:e.coords.heading,climb:0,tilt:0,speed:s.Li(e.coords.speed),accuracy:s.AD(e.coords.accuracy),altitudeAccuracy:s.AD(e.coords.altitudeAccuracy),method:u}),E=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;"gpsd"===e&&fetch("".concat("https://localhost:8443","/gps")).then((e=>e.json())).then(w).then((e=>d(a.ZP.setGPS(e)))).then((()=>setTimeout(E,t,u))).catch(b),"geolocation"===e&&(()=>{var e,n;null!==(e=navigator)&&void 0!==e&&null!==(n=e.permissions)&&void 0!==n&&n.query?navigator.permissions.query({name:"geolocation"}).then((e=>{"granted"===e.state||"prompt"===e.state?(p(!0),navigator.geolocation.getCurrentPosition((e=>{d(a.ZP.setGPS(P(e))),setTimeout(E,t)}),b,{enableHighAccuracy:!0})):(y(!1),b("Geolocation API permission denied by system"))})).catch((e=>{v?b(e):y(!1)})):navigator.geolocation&&navigator.geolocation.getCurrentPosition((e=>{d(a.ZP.setGPS(P(e))),setTimeout(E,t)}),b,{enableHighAccuracy:!0})})()};return(0,o.useEffect)((()=>j(0)),[u]),(0,o.useEffect)((()=>E(u)),[]),"geolocation"!==u||v||f?null:(0,r.jsx)(l.Z,{onConfirm:()=>{y(!0),E()},onCancel:()=>{y(!0),b("Geolocation API permission denied by user",!0)},children:(0,r.jsx)("span",{className:"show-unlit","data-unlit":s.jB(3,20),children:"You must grant permission to access GPS."})})};d.defaultProps={interval:1e3};const u=d},5605:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var o=n(2791),i=n(2007),l=n.n(i),s=["color","size","title"];function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a.apply(this,arguments)}function r(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},l=Object.keys(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=(0,o.forwardRef)((function(e,t){var n=e.color,i=e.size,l=e.title,c=r(e,s);return o.createElement("svg",a({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n},c),l?o.createElement("title",null,l):null,o.createElement("path",{d:"M8 16.016a7.5 7.5 0 0 0 1.962-14.74A1 1 0 0 0 9 0H7a1 1 0 0 0-.962 1.276A7.5 7.5 0 0 0 8 16.016zm6.5-7.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"}),o.createElement("path",{d:"m6.94 7.44 4.95-2.83-2.83 4.95-4.949 2.83 2.828-4.95z"}))}));c.propTypes={color:l().string,size:l().oneOfType([l().string,l().number]),title:l().string},c.defaultProps={color:"currentColor",size:"1em",title:null};const d=c;var u=n(7830),g=n(4420),m=(n(5199),n(534)),h=n(8978),v=n(3329);let p=null;const f=e=>{let{interval:t=1,onUpdate:n,...i}=e;const[l,s]=(0,o.useState)("orientation"),[a,r]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!0),[u,g]=(0,o.useState)(0),f=e=>{g((e=>e+1)),console.log("Failed to get position via ".concat(l)),console.error(e.type)},y=e=>({heading:e.z,climb:e.y,tilt:e.x,method:l}),x=e=>(console.log("GYRO",e),{heading:e.webkitCompassHeading||e.alpha||0,climb:e.beta?e.beta-90:0,tilt:e.gamma||0,method:l,failures:u}),j=()=>{"orientation"===l&&(DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((e=>{"granted"===e?(r(!0),window.addEventListener("deviceorientation",(e=>n(x(e))),{})):(d(!1),f("Device Motion API permission denied"))})).catch((e=>{e.name.includes("NotAllowedError")&&d(!1),f(e)})):window.addEventListener("deviceorientation",(e=>n(x(e))))),"gyroscope"===l&&(()=>{var e,o;null!==(e=navigator)&&void 0!==e&&null!==(o=e.permissions)&&void 0!==o&&o.query?navigator.permissions.query({name:"gyroscope"}).then((e=>{"granted"===e.state||"prompt"===e.state?(console.log("Permission granted"),p=new window.Gyroscope({frequency:t}),p.addEventListener("reading",(e=>{n(y(p)),console.log("Angular velocity along the X-axis ".concat(p.x)),console.log("Angular velocity along the Y-axis ".concat(p.y)),console.log("Angular velocity along the Z-axis ".concat(p.z))})),p.start()):f("Gyroscope API permission denied")})).catch(f):window.Gyroscope&&(console.log("Permission not granted"),p=new window.Gyroscope({frequency:t}),p.addEventListener("reading",(e=>{n(y(p)),console.log("Angular velocity along the X-axis ".concat(p.x)),console.log("Angular velocity along the Y-axis ".concat(p.y)),console.log("Angular velocity along the Z-axis ".concat(p.z))})),p.start())})()};return(0,o.useEffect)(j,[]),a||c?null:(0,v.jsx)(m.Z,{onConfirm:()=>{d(!0),j()},onCancel:()=>{d(!0)},children:(0,v.jsx)("span",{className:"show-unlit","data-unlit":h.jB(3,20),children:"You must grant permission to access the gyroscope."})})};f.defaultProps={interval:1};const y=f;var x=n(1930);const j=e=>{const t=(0,g.v9)(x.$2),n=(0,g.v9)(x.RJ),[i,l]=((0,g.v9)(x.$w),(0,o.useState)(null)),s=()=>{var e,t,n,o,i,l;const s=(null===(e=document.getElementById("compass-coordinates"))||void 0===e?void 0:e.clientHeight)||0,a=(null===(t=document.getElementById("compass-positioning"))||void 0===t?void 0:t.clientHeight)||0,r=(null===(n=document.getElementById("top"))||void 0===n?void 0:n.clientHeight)||0,c=(null===(o=document.getElementById("bottom"))||void 0===o?void 0:o.clientHeight)||0,d=(null===(i=document.getElementById("content"))||void 0===i?void 0:i.clientHeight)||0,u=(null===(l=document.getElementById("content"))||void 0===l?void 0:l.clientWidth)||0;return Math.min(d-r-c-a-s,u)},a=()=>{if(null===n||void 0===n||!n.latitude)return"";const e=(null===n||void 0===n?void 0:n.latitude)>=0?"N":"S",t=Math.abs(null===n||void 0===n?void 0:n.latitude).toFixed(3);return(0,v.jsxs)(v.Fragment,{children:[t,(0,v.jsxs)("span",{className:"units",children:["\xb0 ",e]})]})},r=()=>{if(null===n||void 0===n||!n.longitude)return"";const e=(null===n||void 0===n?void 0:n.latitude)>=0?"E":"W",t=Math.abs(null===n||void 0===n?void 0:n.longitude).toFixed(3);return(0,v.jsxs)(v.Fragment,{children:[t,(0,v.jsxs)("span",{className:"units",children:["\xb0 ",e]})]})},c=()=>{const e="imperial"===t.units?"ft":"m",o=Math.floor((null===n||void 0===n?void 0:n.altitude)||0),i=o<0?"-":"";let l=o<0?3:4;return"m"===e&&l++,(0,v.jsxs)(v.Fragment,{children:[i,String(Math.abs(o)).padStart(l,"0"),(0,v.jsxs)("span",{className:"units",children:[" ",e]})]})},m=()=>{const e="imperial"===t.units?"mph":"km/h",o=Math.floor((null===n||void 0===n?void 0:n.speed)||0),i=o<0?"-":"";let l=o<0?2:3;return"m"===e&&l--,(0,v.jsxs)(v.Fragment,{children:[i,String(Math.abs(o)).padStart(l,"0"),(0,v.jsxs)("span",{className:"units",children:[" ",e]})]})};return console.log("GPS",n),null===n?(0,v.jsxs)("div",{className:"loading-screen",children:[(0,v.jsx)(d,{className:"big-icon"}),(0,v.jsx)("div",{id:"weather-description",className:"show-unlit","data-unlit":h.ro("Compass loading..."),children:"Compass loading..."})]}):-1===n?(0,v.jsxs)("div",{className:"loading-screen",children:[(0,v.jsx)(u.Z,{className:"big-icon"}),(0,v.jsx)("div",{id:"weather-description",className:"show-unlit","data-unlit":h.ro("Error getting location"),children:"Error getting location"})]}):(0,v.jsxs)("div",{id:"compass",children:[(0,v.jsx)(y,{onUpdate:l}),(0,v.jsxs)("div",{id:"compass-coordinates",children:[(0,v.jsx)("span",{id:"compass-coordinates-latitude",className:"show-unlit","data-unlit":h.ro(a()),children:a()}),(0,v.jsx)("span",{id:"compass-coordinates-longitude",className:"show-unlit","data-unlit":h.ro(r()),children:r()})]}),(0,v.jsxs)("div",{id:"compass-compass",style:{height:s(),width:s()},children:[(0,v.jsx)("div",{id:"compass-directions",style:{transform:"rotate(".concat((null===i||void 0===i?void 0:i.heading)||0,"deg)")}}),(0,v.jsx)("div",{id:"compass-tilt",style:{transform:"rotate(".concat((null===i||void 0===i?void 0:i.tilt)||0,"deg)")}}),(0,v.jsx)("div",{id:"compass-tilt-value",children:"".concat(Math.round((null===i||void 0===i?void 0:i.tilt)||0),"\xb0")}),(0,v.jsx)("div",{id:"compass-climb",style:{backgroundPositionY:"".concat(79*-((null===i||void 0===i?void 0:i.climb)||0)/45+50,"%")}})]}),(0,v.jsxs)("div",{id:"compass-positioning",children:[(0,v.jsxs)("div",{id:"compass-altitude",className:"show-unlit","data-unlit":h.ro(c()),children:[c(),(0,v.jsx)("br",{})]}),(0,v.jsxs)("div",{id:"compass-speed",className:"show-unlit","data-unlit":h.ro(m()),children:[m(),(0,v.jsx)("br",{})]})]})]})}},7830:(e,t,n)=>{n.d(t,{Z:()=>d});var o=n(2791),i=n(2007),l=n.n(i),s=["color","size","title"];function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a.apply(this,arguments)}function r(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},l=Object.keys(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=(0,o.forwardRef)((function(e,t){var n=e.color,i=e.size,l=e.title,c=r(e,s);return o.createElement("svg",a({ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:i,height:i,fill:n},c),l?o.createElement("title",null,l):null,o.createElement("path",{fillRule:"evenodd",d:"M3.1 11.2a.5.5 0 0 1 .4-.2H6a.5.5 0 0 1 0 1H3.75L1.5 15h13l-2.25-3H10a.5.5 0 0 1 0-1h2.5a.5.5 0 0 1 .4.2l3 4a.5.5 0 0 1-.4.8H.5a.5.5 0 0 1-.4-.8l3-4z"}),o.createElement("path",{fillRule:"evenodd",d:"M8 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6zM4 4a4 4 0 1 1 4.5 3.969V13.5a.5.5 0 0 1-1 0V7.97A4 4 0 0 1 4 3.999z"}))}));c.propTypes={color:l().string,size:l().oneOfType([l().string,l().number]),title:l().string},c.defaultProps={color:"currentColor",size:"1em",title:null};const d=c}}]);
//# sourceMappingURL=605.983201c2.chunk.js.map